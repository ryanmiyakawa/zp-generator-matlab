% Find abb mix with given rms val:

z4_8mix = [.2, -.2, .1, .05, .1];
z4_10mix = [.2, -.2, .1, .05, .1, -.1, -.1];
z4_15mix = [.3, .2, -.3, .15, .1, .15, -.1, -.1, .05, .05, -.05, .1];
z4_24mix = [-25.3572
   14.7034
   32.6047
    9.5334
   19.6592
   13.4474
   -5.4619
    5.1428
  -13.3838
   14.6585
  -18.3531
  -16.5675
  -12.1425
  -42.6921
   20.1373
    4.3901
   -9.8141
   17.1287
  -20.5382
   -1.1758
   -2.6559
]';

z4_37mix = [  -57.4930
  -57.6062
   19.5278
   -7.0063
   -7.6461
   54.6434
   11.0802
    7.4179
   58.7449
  -29.3630
   25.0785
   29.6456
   -8.5300
    7.4406
  -39.6387
  -38.4564
    3.4609
   23.4733
   82.7357
  -21.0071
    5.8073
   -2.5161
  -57.9907
  -12.9495
  -52.0457
   23.9507
  -24.8649
    2.7526
  -14.7023
    8.0433
  -15.6085
   12.4941
   18.4841]';

zTDSWC = [-0.0036
   -0.0024
    0.0019
   -0.0034
    0.0146
   -0.0171
   -0.0029
   -0.0045
   -0.0008
    0.0055
   -0.0053
   -0.0044
    0.0054
    0.0013
    0.0033
    0.0022
    0.0028
   -0.0003
    0.0003
    0.0012
    0.0007]';

zTDSWC37 = [zTDSWC'
    0.005
    0.004
    0.005
    -0.005
    -0.004
    -0.005
     0.005
    0.004
    0.005
    -0.005
    -0.004
    -0.005
    -0.01]';



%  z = z4_8mix;
% z = z4_15mix;
%  z = z4_24mix;
 z = z4_37mix;
% 
% z = zTDSWC;
%z = z4_10mix;

rmsMag = 0.01;


rmsVal = rms(abdom(pinhole(300), [0,0,0,0, z]));
fprintf('RMSVal: %d mWaves\n', 1000*rmsMag);
fprintf('[');
for k = 1:length(z)
    fprintf('%d %0.4f ', k + 3, z(k)/rmsVal*rmsMag);    
    
end
fprintf(']\n');